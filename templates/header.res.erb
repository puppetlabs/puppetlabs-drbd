resource <%= name %> {

  volume 0 {
    device    <%= device %>;
    disk      <%= disk %>;
    meta-disk internal;

    disk {
<% if @rate -%>
      resync-rate <%= @rate %>;
<% end -%>
<% if @disk_parameters -%>
  <% @disk_parameters.sort_by {|k, v| k}.each do |k, v| -%>
  <%= k %> <%= v %>;
  <% end -%>
<% end -%>
    }
  }

  handlers {
<% if @handler_parameters -%>
  <% @handler_parameters.sort_by {|k, v| k}.each do |k, v| -%>
  <%= k %> <%= v %>;
  <% end -%>
<% end -%>
}

  net {
    cram-hmac-alg sha1;
<% if secret -%>
    shared-secret "<%= secret %>";
<% end -%>
    #allow-two-primaries;
<% if @net_parameters -%>
  <% @net_parameters.sort_by {|k, v| k}.each do |k, v| -%>
  <%= k %> <%= v %>;
  <% end -%>
<% end -%>
}

  syncer {
    verify-alg <%= verify_alg %>;
<% if @rate -%>
    rate <%= @rate %>;
<% end -%>
<% if @syncer_parameters -%>
  <% @syncer_parameters.sort_by {|k, v| k}.each do |k, v| -%>
  <%= k %> <%= v %>;
  <% end -%>
<% end -%>
}

